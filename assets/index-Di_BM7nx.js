var y=(_,c,s)=>new Promise((p,o)=>{var u=a=>{try{r(s.next(a))}catch(l){o(l)}},d=a=>{try{r(s.throw(a))}catch(l){o(l)}},r=a=>a.done?p(a.value):Promise.resolve(a.value).then(u,d);r((s=s.apply(_,c)).next())});import{D as A,am as L,bo as E,ay as U,p as S,z as v,f as F,u as N,bp as T}from"./index.js";import{c as M,u as q}from"./index-Bhsirk9D.js";import{a as z,B as j,u as x}from"./index-Ct8wWWt8.js";import{h as G}from"./header-7M7o_qvT.js";import{_ as H}from"./useForm-CXmX13n8.js";import{d as $,f as W,Z as k,a5 as C,a6 as i,aa as Z,u as e,a7 as J,k as n,G as I,c as K,_ as Q,F as X,a9 as R,$ as h,a1 as P,a0 as Y}from"./vue-C-fXn5x4.js";import{D as ee,x as oe}from"./antd-Dxxf6MN8.js";import"./index-HOjRdrl6.js";import"./useContentViewHeight-BWw0knoZ.js";import"./useWindowSizeFn-B-ZcP_zC.js";import"./useSortable-CgitHRn_.js";import"./lock-9rzsJSPp.js";import"./useFormItem-Djb2ixBi.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-Dg46GCSa.js";import"./index-sb4rP5N6.js";import"./onMountedOrActivated-C8ZkvEWz.js";import"./index-CYD2Ni35.js";import"./sortable.esm-CXi5ODBW.js";import"./index-1ocsCaln.js";import"./copyTextToClipboard-C3IjWpoG.js";import"./index-Cb7zAOWj.js";const te=$({__name:"AnnoResetPwdModal",setup(_){const{createMessage:c}=U(),{getIsMobile:s}=A(),p=L(),o=W(null),u=[{field:"oldPwd",component:"InputPassword",label:"原密码",colProps:{span:24},componentProps:{placeholder:"请输入原密码"},rules:[{required:!0}]},{field:"newPwd1",component:"InputPassword",label:"新密码",colProps:{span:24},componentProps:{placeholder:"请输入新密码"},rules:[{required:!0}]},{field:"newPwd2",component:"InputPassword",label:"新密码",colProps:{span:24},componentProps:{placeholder:"请再次输入新密码"},rules:[{required:!0}]}],[d,{setModalProps:r,closeModal:a}]=z(m=>y(this,null,function*(){r({confirmLoading:!1,cancelText:"关闭",defaultFullscreen:s.value})}));function l(){o.value.resetFields(),a()}function g(){o.value.validate().then(m=>y(this,null,function*(){var t=o.value.getFieldsValue();if(t.newPwd1!==t.newPwd2){c.error("两次输入的新密码不一致");return}if(t.oldPwd===t.newPwd1){c.error("新密码不能与旧密码一致");return}E({oldPwd:t.oldPwd,newPwd1:t.newPwd1,newPwd2:t.newPwd2}).then(f=>{c.success("重置密码成功"),a(),p.logout(!0)}),yield o.value.resetFields()}))}return(m,t)=>{const f=J("a-button");return k(),C(e(j),Z(m.$attrs,{onRegister:e(d),title:"重置用户密码",onOk:g,onCancel:l}),{footer:i(()=>[n(f,{key:"back",onClick:l},{default:i(()=>t[0]||(t[0]=[I(" 取消 ")])),_:1}),n(f,{key:"submit",type:"primary",onClick:g},{default:i(()=>t[1]||(t[1]=[I(" 重置密码 ")])),_:1})]),default:i(()=>[n(e(H),{labelWidth:100,schemas:u,ref_key:"formElRef",ref:o,showResetButton:!1,showSubmitButton:!1,actionColOptions:{span:24}},null,512)]),_:1},16,["onRegister"])}}}),ae=["src"],xe=$({name:"UserDropdown",__name:"index",props:{theme:S.oneOf(["dark","light"])},setup(_){const{createMessage:c}=U(),s=M(()=>v(()=>import("./DropMenuItem-DuEuu_k_.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),p=M(()=>v(()=>import("./LockModal-BQyWI4f7.js"),__vite__mapDeps([5,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]),import.meta.url)),{prefixCls:o}=F("header-user-dropdown"),{t:u}=N(),{getUseLockPage:d}=q(),r=L(),a=K(()=>{const{name:w="",avatar:b}=r.getUserInfo||{};return{name:w,avatar:b||G}}),[l,{openModal:g}]=x(),[m,{openModal:t}]=x();function f(){g(!0)}function B(){r.confirmLoginOut()}function D(){T().then(w=>{c.success("缓存清除成功")})}function O(){t(!0)}function V(w){switch(w.key){case"logout":B();break;case"lock":f();break;case"clearUserCache":D();break;case"changeUserPassword":O();break}}return(w,b)=>(k(),Q(X,null,[n(e(ee),{placement:"bottomLeft",overlayClassName:`${e(o)}-dropdown-overlay`},{overlay:i(()=>[n(e(oe),{onClick:V},{default:i(()=>[e(d)?(k(),C(e(s),{key:"clearUserCache",text:"清除缓存",icon:"ant-design:clear-outlined"})):R("",!0),n(e(s),{key:"changeUserPassword",text:"修改密码",icon:"ant-design:security-scan-outlined"}),e(d)?(k(),C(e(s),{key:"lock",text:e(u)("layout.header.tooltipLock"),icon:"ion:lock-closed-outline"},null,8,["text"])):R("",!0),n(e(s),{key:"logout",text:e(u)("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])]),_:1})]),default:i(()=>[h("span",{class:P([[e(o),`${e(o)}--${_.theme}`],"flex"])},[h("img",{class:P(`${e(o)}__header`),src:a.value.avatar},null,10,ae),h("span",{class:P(`${e(o)}__info hidden md:block`)},[h("span",{class:P([`${e(o)}__name`,"truncate"])},Y(a.value.name),3)],2)],2)]),_:1},8,["overlayClassName"]),n(e(p),{onRegister:e(l)},null,8,["onRegister"]),n(te,{onRegister:e(m)},null,8,["onRegister"])],64))}});export{xe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./DropMenuItem-DuEuu_k_.js","./index.js","./vue-C-fXn5x4.js","./antd-Dxxf6MN8.js","./index-Co3tBknn.css","./LockModal-BQyWI4f7.js","./index-Ct8wWWt8.js","./useWindowSizeFn-B-ZcP_zC.js","./index-CiFfgH5n.css","./useForm-CXmX13n8.js","./useFormItem-Djb2ixBi.js","./RadioButtonGroup.vue_vue_type_script_setup_true_lang-Dg46GCSa.js","./useSortable-CgitHRn_.js","./index-sb4rP5N6.js","./onMountedOrActivated-C8ZkvEWz.js","./index-CYD2Ni35.js","./index-z9U7zjFW.css","./sortable.esm-CXi5ODBW.js","./index-1ocsCaln.js","./index-Bn5udUWy.css","./copyTextToClipboard-C3IjWpoG.js","./index-Cb7zAOWj.js","./index-B1prL0gx.css","./useForm-pdOmfp_0.css","./lock-9rzsJSPp.js","./header-7M7o_qvT.js","./LockModal-CETB33ga.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}