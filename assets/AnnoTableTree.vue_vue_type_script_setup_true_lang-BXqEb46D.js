var Ge=Object.defineProperty,qe=Object.defineProperties;var Qe=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var ke=(e,n,a)=>n in e?Ge(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,M=(e,n)=>{for(var a in n||(n={}))Ze.call(n,a)&&ke(e,a,n[a]);if(pe)for(var a of pe(n))et.call(n,a)&&ke(e,a,n[a]);return e},ge=(e,n)=>qe(e,Qe(n));var ne=(e,n,a)=>new Promise((x,k)=>{var S=y=>{try{s(a.next(y))}catch(C){k(C)}},l=y=>{try{s(a.throw(y))}catch(C){k(C)}},s=y=>y.done?x(y.value):Promise.resolve(y.value).then(S,l);s((a=a.apply(e,n)).next())});import{am as tt,d as Q,f as H,af as nt,c as N,w as O,Z as B,_ as P,u as i,ac as lt,a9 as j,a5 as le,a6 as $,k as g,G as ae,a0 as ce,a1 as xe,F as X,a8 as at,aa as Be,B as ct,l as Se,o as Ne,y as st,b as Ie,i as Me,x as rt,g as it,r as Ce,J,h as Y,m as ve,A as be}from"./vue-C-fXn5x4.js";import{aH as ot,u as ut,a5 as dt,m as q,A as ft,aI as Ke,aJ as ht,aK as yt,aL as pt,aM as kt,aN as gt,aO as me,S as xt,aP as Te,aQ as St,ay as Ct}from"./index.js";import{ag as vt,ah as bt,T as Kt,ai as mt,aj as Tt,ak as Lt,x as G,D as _t,l as At,f as ie,aa as Et,al as wt,o as Dt,e as se,G as Ft,ae as Bt,am as Le,an as Nt,v as It,Y as _e}from"./antd-Dxxf6MN8.js";function oe(e,n){return n?typeof n=="string"?` ${e}--${n}`:Array.isArray(n)?n.reduce((a,x)=>a+oe(e,x),""):Object.keys(n).reduce((a,x)=>a+(n[x]?oe(e,x):""),""):""}function Mt(e){return(n,a)=>(n&&typeof n!="string"&&(a=n,n=""),n=n?`${e}__${n}`:e,`${n}${oe(n,a)}`)}function $e(e){return[Mt(`${ot}-${e}`)]}const Ae=Symbol(),Ee=Symbol();function $t(e,n){if(!bt(e)||e[Ee])return e;const{values:a,required:x,default:k,type:S,validator:l}=e,s=a||l?y=>{let C=!1,v=[];if(a&&(v=[...a,k],C||(C=v.includes(y))),l&&(C||(C=l(y))),!C&&v.length>0){const r=[...new Set(v)].map(f=>JSON.stringify(f)).join(", ");tt(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${r}], got value ${JSON.stringify(y)}.`)}return C}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Ae)&&S?S[Ae]:S,required:!!x,default:k,validator:s,[Ee]:!0}}const Ot=e=>vt(Object.entries(e).map(([n,a])=>[n,$t(a,n)]));var E=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(E||{});const jt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Pt=Ot({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},titleClickFunc:{type:Function},titleToolTip:{type:String,default:""},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Ut={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Ht=Q({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},titleToolTip:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0},titleClickFunc:{type:Function,default:()=>{}}},emits:["strictly-change","search"],setup(e,{emit:n}){const a=H(""),[x]=$e("tree-header"),k=e,S=n,l=nt(),{t:s}=ut(),y=N(()=>["mr-1","w-full",{"ml-5":l.headerTitle||k.title}]),C=N(()=>{const{checkable:t}=k,o=[{label:s("component.tree.expandAll"),value:E.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:E.UN_EXPAND_ALL,divider:t}];return t?[{label:s("component.tree.selectAll"),value:E.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:E.UN_SELECT_ALL,divider:t},...o,{label:s("component.tree.checkStrictly"),value:E.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:E.CHECK_UN_STRICTLY}]:o}),v=({key:t})=>{var o,u,h,d;switch(t){case E.SELECT_ALL:(o=k.checkAll)==null||o.call(k,!0);break;case E.UN_SELECT_ALL:(u=k.checkAll)==null||u.call(k,!1);break;case E.EXPAND_ALL:(h=k.expandAll)==null||h.call(k,!0);break;case E.UN_EXPAND_ALL:(d=k.expandAll)==null||d.call(k,!1);break;case E.CHECK_STRICTLY:S("strictly-change",!1);break;case E.CHECK_UN_STRICTLY:S("strictly-change",!0);break}};function r(t){S("search",t)}const f=ft(r,200);return O(()=>a.value,t=>{f(t)}),O(()=>k.searchText,t=>{t!==a.value&&(a.value=t)}),(t,o)=>(B(),P("div",{class:xe([i(x)(),"flex px-2 py-1.5 items-center"])},[i(l).headerTitle?lt(t.$slots,"headerTitle",{key:0}):j("",!0),!i(l).headerTitle&&t.title?(B(),le(i(dt),{key:1,helpMessage:t.helpMessage,onClick:k.titleClickFunc},{default:$(()=>[g(i(Kt),{placement:"left",color:"#0960bd"},{title:$(()=>[ae(ce(t.titleToolTip||t.title),1)]),default:$(()=>[ae(" "+ce(t.title),1)]),_:1})]),_:1},8,["helpMessage","onClick"])):j("",!0),t.search||t.toolbar?(B(),P("div",Ut,[t.search?(B(),P("div",{key:0,class:xe(y.value)},[g(i(mt),{placeholder:i(s)("common.searchText"),size:"small",allowClear:"",value:a.value,"onUpdate:value":o[0]||(o[0]=u=>a.value=u)},null,8,["placeholder","value"])],2)):j("",!0),t.toolbar?(B(),le(i(_t),{key:1,onClick:o[1]||(o[1]=ct(()=>{},["prevent"]))},{overlay:$(()=>[g(i(G),{onClick:v},{default:$(()=>[(B(!0),P(X,null,at(C.value,u=>(B(),P(X,{key:u.value},[g(i(Tt),Be({ref_for:!0},{key:u.value}),{default:$(()=>[ae(ce(u.label),1)]),_:2},1040),u.divider?(B(),le(i(Lt),{key:0})):j("",!0)],64))),128))]),_:1})]),default:$(()=>[g(q,{icon:"ion:ellipsis-vertical"})]),_:1})):j("",!0)])):j("",!0)],2))}}),Vt=({icon:e})=>e?At(e)?Se(q,{icon:e,class:"mr-1"}):Se(q):null;function Yt(e,n){function a(r){const f=[],t=r||i(e),{key:o,children:u}=i(n);if(!u||!o)return f;for(let h=0;h<t.length;h++){const d=t[h];f.push(d[o]);const b=d[u];b&&b.length&&f.push(...a(b))}return f}function x(r){const f=[],t=r||i(e),{key:o,children:u}=i(n);if(!u||!o)return f;for(let h=0;h<t.length;h++){const d=t[h];d.disabled!==!0&&d.selectable!==!1&&f.push(d[o]);const b=d[u];b&&b.length&&f.push(...x(b))}return f}function k(r,f){const t=[],o=f||i(e),{key:u,children:h}=i(n);if(!h||!u)return t;for(let d=0;d<o.length;d++){const b=o[d],_=b[h];r===b[u]?(t.push(b[u]),_&&_.length&&t.push(...a(_))):_&&_.length&&t.push(...k(r,_))}return t}function S(r,f,t){if(!r)return;const o=t||i(e),{key:u,children:h}=i(n);if(!(!h||!u))for(let d=0;d<o.length;d++){const b=o[d],_=b[h];if(b[u]===r){o[d]=M(M({},o[d]),f);break}else _&&_.length&&S(r,f,b[h])}}function l(r=1,f,t=1){if(!r)return[];const o=[],u=f||i(e)||[];for(let h=0;h<u.length;h++){const d=u[h],{key:b,children:_}=i(n),Z=b?d[b]:"",V=_?d[_]:[];o.push(Z),V&&V.length&&t<r&&(t+=1,o.push(...l(r,V,t)))}return o}function s({parentKey:r=null,node:f,push:t="push"}){const o=ie(i(e));if(!r){o[t](f),e.value=o;return}const{key:u,children:h}=i(n);!h||!u||(Ke(o,d=>{if(d[u]===r)return d[h]=d[h]||[],d[h][t](f),!0}),e.value=o)}function y({parentKey:r=null,list:f,push:t="push"}){const o=ie(i(e));if(!(!f||f.length<1))if(r){const{key:u,children:h}=i(n);if(!h||!u)return;Ke(o,d=>{if(d[u]===r){d[h]=d[h]||[];for(let b=0;b<f.length;b++)d[h][t](f[b]);return e.value=o,!0}})}else{for(let u=0;u<f.length;u++)o[t](f[u]);e.value=o;return}}function C(r,f){if(!r)return;const t=f||i(e),{key:o,children:u}=i(n);if(!(!u||!o))for(let h=0;h<t.length;h++){const d=t[h],b=d[u];if(d[o]===r){t.splice(h,1);break}else b&&b.length&&C(r,d[u])}}function v(r,f,t){if(!r&&r!==0)return null;const o=f||i(e),{key:u,children:h}=i(n);return u?(o.forEach(d=>{if(t!=null&&t.key||(t==null?void 0:t.key)===0)return t;if(d[u]===r){t=d;return}d[h]&&d[h].length&&(t=v(r,d[h],t))}),t||null):null}return{deleteNodeByKey:C,insertNodeByKey:s,insertNodesByKey:y,filterByLevel:l,updateNodeByKey:S,getAllKeys:a,getChildrenKeys:k,getEnabledKeys:x,getSelectedNode:v}}function Xt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const re="context-menu",Rt={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},we=e=>{const{item:n}=e;return g("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,n)},[e.showIcon&&n.icon&&g(q,{class:"mr-2",icon:n.icon},null),g("span",null,[n.label])])},zt=Q({name:"ContextMenu",props:Rt,setup(e){const n=H(null),a=H(!1),x=N(()=>{const{axis:l,items:s,styles:y,width:C}=e,{x:v,y:r}=l||{x:0,y:0},f=(s||[]).length*40,t=C,o=document.body,u=o.clientWidth<v+t?v-t:v,h=o.clientHeight<r+f?r-f:r;return M({position:"absolute",width:`${C}px`,left:`${u+1}px`,top:`${h+1}px`,zIndex:9999},y)});Ne(()=>{st(()=>a.value=!0)}),Ie(()=>{const l=i(n);l&&document.body.removeChild(l)});function k(l,s){const{handler:y,disabled:C}=l;C||(a.value=!1,s==null||s.stopPropagation(),s==null||s.preventDefault(),y==null||y())}function S(l){return l.filter(y=>!y.hidden).map(y=>{const{disabled:C,label:v,children:r,divider:f=!1}=y,t={item:y,handler:k,showIcon:e.showIcon};return!r||r.length===0?g(X,null,[g(G.Item,{disabled:C,class:`${re}__item`,key:v},{default:()=>[g(we,t,null)]}),f?g(Et,{key:`d-${v}`},null):null]):i(a)?g(G.SubMenu,{key:v,disabled:C,popupClassName:`${re}__popup`},{title:()=>g(we,t,null),default:()=>S(r)}):null})}return()=>{let l;if(!i(a))return null;const{items:s}=e;return g(G,{inlineIndent:12,mode:"vertical",class:re,ref:n,style:i(x)},Xt(l=S(s))?l:{default:()=>[l]})}}}),U={domList:[],resolve:()=>{}},Wt=function(e){const{event:n}=e||{};if(n&&(n==null||n.preventDefault()),!!ht)return new Promise(a=>{const x=document.body,k=document.createElement("div"),S={};e.styles&&(S.styles=e.styles),e.items&&(S.items=e.items),e.event&&(S.customEvent=n,S.axis={x:n.clientX,y:n.clientY});const l=g(zt,S);rt(l,k);const s=function(){U.resolve("")};U.domList.push(k);const y=function(){U.domList.forEach(C=>{try{C&&x.removeChild(C)}catch(v){}}),x.removeEventListener("click",s),x.removeEventListener("scroll",s)};U.resolve=function(C){y(),a(C)},y(),x.appendChild(k),x.addEventListener("click",s),x.addEventListener("scroll",s)})},De=function(){U.resolve(""),U.domList=[]};function Jt(e=!0){return it()&&e&&Ie(()=>{De()}),[Wt,De]}function Fe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const Gt=Q({name:"BasicTree",inheritAttrs:!1,props:Pt,emits:jt,setup(e,{attrs:n,slots:a,emit:x,expose:k}){const[S]=$e("tree"),l=Ce({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),s=Ce({startSearch:!1,searchText:"",searchData:[]}),y=H([]),[C]=Jt(),v=N(()=>{const{fieldNames:c}=e;return M({children:"children",title:"title",key:"key"},c)}),r=N(()=>{let c=ge(M(M({blockNode:!0},n),e),{expandedKeys:l.expandedKeys,selectedKeys:l.selectedKeys,checkedKeys:l.checkedKeys,checkStrictly:l.checkStrictly,fieldNames:i(v),"onUpdate:expandedKeys":p=>{l.expandedKeys=p,x("update:expandedKeys",p)},"onUpdate:selectedKeys":p=>{l.selectedKeys=p,x("update:selectedKeys",p)},onCheck:(p,m)=>{let K=J(l.checkedKeys);if(yt(K)&&s.startSearch){const L=m.node.eventKey;K=wt(K,Z(L)),m.checked&&K.push(L),l.checkedKeys=K}else l.checkedKeys=p;const T=J(l.checkedKeys);x("update:value",T),x("check",T,m)},onRightClick:Pe});return Dt(c,"treeData","class")}),f=N(()=>s.startSearch?s.searchData:i(y)),t=N(()=>!f.value||f.value.length===0),{deleteNodeByKey:o,insertNodeByKey:u,insertNodesByKey:h,filterByLevel:d,updateNodeByKey:b,getAllKeys:_,getChildrenKeys:Z,getEnabledKeys:V,getSelectedNode:Oe}=Yt(y,v);function je(c,p){return!p&&e.renderIcon&&se(e.renderIcon)?e.renderIcon(c):p}function Pe(m){return ne(this,arguments,function*({event:c,node:p}){var I;const{rightMenuList:K=[],beforeRightClick:T}=e;let L={event:c,items:[]};if(T&&se(T)){let w=yield T(p,c);Array.isArray(w)?L.items=w:Object.assign(L,w)}else L.items=K;(I=L.items)!=null&&I.length&&(L.items=L.items.filter(w=>!w.hidden),C(L))})}function R(c){l.expandedKeys=c}function Ue(){return l.expandedKeys}function ue(c){l.selectedKeys=c}function He(){return l.selectedKeys}function de(c){l.checkedKeys=c}function Ve(){return l.checkedKeys}function fe(c){l.checkedKeys=c?V():[]}function ee(c){l.expandedKeys=c?_():[]}function Ye(c){l.checkStrictly=c}O(()=>e.searchValue,c=>{c!==s.searchText&&(s.searchText=c)},{immediate:!0}),O(()=>e.treeData,c=>{c&&te(s.searchText)});function te(c){if(c!==s.searchText&&(s.searchText=c),x("update:searchValue",c),!c){s.startSearch=!1;return}const{filterFn:p,checkable:m,expandOnSearch:K,checkOnSearch:T,selectedOnSearch:L}=i(e);s.startSearch=!0;const{title:I,key:w}=i(v),D=[];if(s.searchData=pt(i(y),A=>{var z,W;const F=p?p(c,A,i(v)):(W=(z=A[I])==null?void 0:z.includes(c))!=null?W:!1;return F&&D.push(A[w]),F},i(v)),K){const A=kt(s.searchData).map(F=>F[w]);A&&A.length&&R(A)}T&&m&&D.length&&de(D),L&&D.length&&ue(D)}function Xe(c,p){if(!(!e.clickRowToExpand||!p||p.length===0))if(!l.expandedKeys.includes(c))R([...l.expandedKeys,c]);else{const m=[...l.expandedKeys],K=m.findIndex(T=>T===c);K!==-1&&m.splice(K,1),R(m)}}Y(()=>{y.value=e.treeData}),Ne(()=>{const c=parseInt(e.defaultExpandLevel);c>0?l.expandedKeys=d(c):e.defaultExpandAll&&ee(!0)}),Y(()=>{l.expandedKeys=e.expandedKeys}),Y(()=>{l.selectedKeys=e.selectedKeys}),Y(()=>{l.checkedKeys=e.checkedKeys}),O(()=>e.value,()=>{l.checkedKeys=J(e.value||[])},{immediate:!0}),O(()=>l.checkedKeys,()=>{const c=J(l.checkedKeys);x("update:value",c),x("change",c)}),Y(()=>{l.checkStrictly=e.checkStrictly});const Re={getTreeData:()=>y,setExpandedKeys:R,getExpandedKeys:Ue,setSelectedKeys:ue,getSelectedKeys:He,setCheckedKeys:de,getCheckedKeys:Ve,insertNodeByKey:u,insertNodesByKey:h,deleteNodeByKey:o,updateNodeByKey:b,getSelectedNode:Oe,checkAll:fe,expandAll:ee,filterByLevel:c=>{l.expandedKeys=d(c)},setSearchValue:c=>{te(c)},getSearchValue:()=>s.searchText};function ze(c){const{actionList:p}=e;if(!(!p||p.length===0))return p.map((m,K)=>{var L;let T=!0;return se(m.show)?T=(L=m.show)==null?void 0:L.call(m,c):_e(m.show)&&(T=m.show),T?g("span",{key:K,class:S("action")},[m.render(c)]):null})}const We=N(()=>{const c=ie(f.value);return gt(c,(p,m)=>{var ye;const K=s.searchText,{highlight:T}=i(e),{title:L,key:I,children:w}=i(v),D=je(p,p.icon),A=Nt(p,L),F=K?A.indexOf(K):-1,z=s.startSearch&&!It(K)&&T&&F!==-1,W=`color: ${_e(T)?"#f50":T}`,Je=z?g("span",{class:(ye=i(r))!=null&&ye.blockNode?`${S("content")}`:""},[g("span",null,[A.substr(0,F)]),g("span",{style:W},[K]),g("span",null,[A.substr(F+K.length)])]):A,he=D?g(Vt,{icon:D},null):a.icon?g("span",{class:"mr-1"},[Te(a,"icon")]):null;return p[L]=g("span",{class:`${S("title")} pl-2`,onClick:Xe.bind(null,p[I],p[w])},[a!=null&&a.title?g(X,null,[he,Te(a,"title",p)]):g(X,null,[he,Je,g("span",{class:S("actions")},[ze(p)])])]),p}),c});return k(Re),()=>{let c,p;const{title:m,helpMessage:K,toolbar:T,search:L,checkable:I,titleClickFunc:w,titleToolTip:D}=e,A=m||T||L||a.headerTitle,F={height:"calc(100% - 38px)","margin-top":"12px"};return g("div",{class:[S(),"h-full",n.class]},[A&&g(Ht,{checkable:I,checkAll:fe,expandAll:ee,titleClickFunc:w,title:m,titleToolTip:D,search:L,toolbar:T,helpMessage:K,onStrictlyChange:Ye,onSearch:te,searchText:s.searchText},Fe(c=me(a))?c:{default:()=>[c]}),g(Ft,{wrapperClassName:i(e.treeWrapperClassName),spinning:i(e.loading),tip:"加载中..."},{default:()=>[ve(g(xt,{style:F},{default:()=>[g(Bt,Be(i(r),{showIcon:!1,treeData:We.value}),Fe(p=me(a,["title"]))?p:{default:()=>[p]})]}),[[be,!i(t)]]),ve(g(Le,{image:Le.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,i(t)]])]})])}}}),qt={class:"overflow-hidden bg-white rounded-md"},nn=Q({name:"AnnoTableTree",__name:"AnnoTableTree",props:{leftTreeClass:{},leftTreeCatKey:{},leftTreeName:{default:"选择分类"}},emits:["select"],setup(e,{emit:n}){const a=n,x=H([]),k=H(window.innerHeight-180),{createMessage:S}=Ct(),l=()=>{s(v.value),S.success("刷新成功")};window.onresize=()=>{k.value=window.innerHeight-180};function s(r){return ne(this,null,function*(){x.value=yield St({annoClazz:r})})}function y(r){a("select",r[0])}const C=e,v=N(()=>{var r;return(r=C.leftTreeClass)==null?void 0:r.split(".").slice(-1)[0]});return O(v,()=>{s(v.value)},{immediate:!0}),(r,f)=>(B(),P("div",qt,[g(i(Gt),{title:C.leftTreeName,toolbar:"",search:"",treeWrapperClassName:"h-[calc(100%-35px)] overflow-auto",titleClickFunc:l,titleToolTip:"点击刷新",clickRowToExpand:!1,treeData:i(x),fieldNames:{key:"id",title:"title"},onSelect:y},null,8,["title","treeData"])]))}});export{nn as _};
