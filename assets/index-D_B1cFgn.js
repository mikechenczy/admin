var T=Object.defineProperty;var P=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var L=(o,n,t)=>n in o?T(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,j=(o,n)=>{for(var t in n||(n={}))N.call(n,t)&&L(o,t,n[t]);if(P)for(var t of P(n))$.call(n,t)&&L(o,t,n[t]);return o};var A=(o,n)=>{var t={};for(var r in o)N.call(o,r)&&n.indexOf(r)<0&&(t[r]=o[r]);if(o!=null&&P)for(var r of P(o))n.indexOf(r)<0&&$.call(o,r)&&(t[r]=o[r]);return t};var w=(o,n,t)=>new Promise((r,F)=>{var d=a=>{try{c(t.next(a))}catch(i){F(i)}},g=a=>{try{c(t.throw(a))}catch(i){F(i)}},c=a=>a.done?r(a.value):Promise.resolve(a.value).then(d,g);c((t=t.apply(o,n)).next())});import U from"./FormRender-BDQfAZF3.js";import{ao as G,b6 as B,f as D,e as O,ac as H,ab as X,o as Y}from"./antd-Dxxf6MN8.js";import{J as I,g as x,d as oo,f as eo,c as k,p as q,u as to,a7 as y,Z as R,_ as J,k as W,a6 as V,F as no,a8 as so,a5 as ro,ab as ao,ac as io,aa as Z}from"./vue-C-fXn5x4.js";import{b as mo,f as z}from"./index-CI2Ks4vl.js";import{bh as fo,_ as lo}from"./index.js";import"./index-CQ-NyP98.js";import"./formItemConfig-QK2ZaEqk.js";import"./useForm-CXmX13n8.js";import"./useFormItem-Djb2ixBi.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-Dg46GCSa.js";import"./index-Ct8wWWt8.js";import"./useWindowSizeFn-B-ZcP_zC.js";import"./useSortable-CgitHRn_.js";import"./index-sb4rP5N6.js";import"./onMountedOrActivated-C8ZkvEWz.js";import"./index-CYD2Ni35.js";import"./sortable.esm-CXi5ODBW.js";import"./index-1ocsCaln.js";import"./copyTextToClipboard-C3IjWpoG.js";import"./index-Cb7zAOWj.js";import"./useFormDesignState-DfF1U7xE.js";function co(o,n,t,r){(()=>{const u=x(),h=u==null?void 0:u.parent;h&&o.formConfig.schemas.forEach(m=>{B(m.componentProps,(b,e)=>{O(b)&&(m.componentProps[e]=b.bind(h))}),B(m.on,(b,e)=>{O(b)&&(m.componentProps[e]=b.bind(h))})})})();const{emit:d}=t,g=G.useForm,{resetFields:c,validate:a,clearValidate:i,validateField:C}=g(n,[]);return{validate:a,validateField:C,resetFields:c,clearValidate:i,submit:()=>w(this,null,function*(){var h,m;const u=D(I(n.value));return d==null||d("submit",u),(m=(h=o.formConfig).submit)==null||m.call(h,u),u})}}function uo(o,n,t,r){const F=e=>mo(o.formConfig.schemas,s=>s.field===e),d=(e,s,f)=>{const l=F(e);l&&(l[s]=f)},g=(e,s,f)=>{const l=F(e);l!=null&&l.componentProps&&(["options","treeData"].includes(s)&&c(e,void 0),l.componentProps[s]=f)},c=(e,s)=>{var f;typeof e=="string"?(o.formModel[e]=s,(f=t.value)==null||f.validateField(e,s,[])):Object.keys(e).forEach(p=>{var M;o.formModel[p]=e[p],(M=t.value)==null||M.validateField(p,e[p],[])})},a=(e,s)=>{o.formConfig[e]=s},i=e=>D(o.formModel)[e],C=()=>w(this,null,function*(){return D(o.formModel)}),v=e=>{d(e,"hidden",!0)},u=e=>{typeof e=="string"?g(e,"disabled",!0):a("disabled",e!==!1)},h=e=>{d(e,"hidden",!1)},m={};return(e=>{z(e,s=>{z(e,f=>{var l;m[f.field]||(m[f.field]=new Set),(l=s.link)!=null&&l.includes(f.field)&&O(s.update)&&m[f.field].add(s)}),m[s.field].add(s)})})(o.formConfig.schemas),j({linkOn:m,setValue:c,getValue:i,hidden:v,show:h,set:d,get:F,setProps:g,getData:C,disable:u},r)}const po=oo({name:"VFormCreate",components:{FormRender:U,Form:G,Row:H},props:{fApi:{type:Object},formModel:{type:Object,default:()=>({})},formConfig:{type:Object,required:!0}},emits:["submit","change","update:fApi","update:formModel"],setup(o,n){const t=o.formConfig.layout=="vertical"?X:H,{emit:r}=n,F=eo(null),d=k({get:()=>o.formModel,set:p=>r("update:formModel",p)}),g=k(()=>o.formConfig.schemas&&o.formConfig.schemas.filter(p=>p.hidden!==!0)),c=fo(o,"fApi",r),{submit:a,validate:i,clearValidate:C,resetFields:v,validateField:u}=co(o,d,n),l=uo({formConfig:o.formConfig,formData:o.formModel},n,F,{submit:a,validate:i,validateField:u,resetFields:v,clearValidate:C}),{linkOn:h}=l,m=A(l,["linkOn"]);c.value=m;const b=p=>{var S;const{schema:M,value:K}=p,{field:Q}=to(M);(S=h[Q])==null||S.forEach(_=>{var E;(E=_.update)==null||E.call(_,K,_,c.value)})},e=k(()=>Y(o.formConfig,["disabled","labelWidth","schemas"])),s=()=>{a()};q("formModel",d);const f=(p,M)=>{d.value[p]=M};return q("setFormModelMethod",f),{eFormModel:F,submit:a,validate:i,validateField:u,resetFields:v,clearValidate:C,handleChange:b,formModelProps:e,handleSubmit:s,setFormModel:f,formModelNew:d,wrapperComp:t,noHiddenList:g}}}),Fo={class:"v-form-container"};function go(o,n,t,r,F,d){const g=y("FormRender"),c=y("Row"),a=y("Form");return R(),J("div",Fo,[W(a,Z({class:"v-form-model",ref:"eFormModel",model:o.formModel},o.formModelProps),{default:V(()=>[W(c,null,{default:V(()=>[(R(!0),J(no,null,so(o.noHiddenList,(i,C)=>(R(),ro(g,{key:C,schema:i,formConfig:o.formConfig,formData:o.formModelNew,onChange:o.handleChange,setFormModel:o.setFormModel,onSubmit:o.handleSubmit,onReset:o.resetFields},ao({_:2},[i&&i.componentProps?{name:"schema.componentProps!.slotName",fn:V(()=>[io(o.$slots,i.componentProps.slotName,Z({ref_for:!0},{formModel:o.formModel,field:i.field,schema:i}),void 0,!0)]),key:"0"}:void 0]),1032,["schema","formConfig","formData","onChange","setFormModel","onSubmit","onReset"]))),128))]),_:3})]),_:3},16,["model"])])}const Ho=lo(po,[["render",go],["__scopeId","data-v-06441f85"]]);export{Ho as default};
