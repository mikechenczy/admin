var h=(x,f,r)=>new Promise((l,g)=>{var t=n=>{try{c(r.next(n))}catch(d){g(d)}},p=n=>{try{c(r.throw(n))}catch(d){g(d)}},c=n=>n.done?l(n.value):Promise.resolve(n.value).then(t,p);c((r=r.apply(x,f)).next())});import{d as $,f as w,r as A,c as N,u as e,Z as P,_ as U,m as F,A as L,k as s,a6 as o,G as v,a0 as _,an as V,F as q}from"./vue-ae6a2213.js";import{u as G,a as K,b as O,L as R,_ as W}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-c52f57e0.js";import{u as Z,f as j,am as H,au as J}from"./index.js";import{ap as E,E as I,aq as Q,B as D,aa as X,ab as Y}from"./antd-8e9c6fb8.js";const ne=$({__name:"LoginForm",setup(x){const f=X,r=Y,l=E.Item,g=I.Password,{t}=Z(),{notification:p,createErrorModal:c}=J(),{prefixCls:n}=j("login"),d=H(),{setLoginState:z,getLoginState:B}=G(),S=w(),y=w(!1),k=w(!1),i=A({account:"",password:"",imageCode:""}),{getFormRules:M}=K(i),{validForm:T}=O(S),C=N(()=>e(B)===R.LOGIN);function b(){return h(this,null,function*(){const m=yield T();if(m)try{y.value=!0;const a=yield d.login({password:m.password,username:m.account,code:m.imageCode,mode:"none"});a&&p.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${a.name}`,duration:3})}catch(a){c({title:t("sys.api.errorTip"),content:a.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{y.value=!1}})}return(m,a)=>(P(),U(q,null,[F(s(W,{class:"enter-x"},null,512),[[L,C.value]]),F(s(e(E),{class:"p-4 enter-x",model:i,rules:e(M),ref_key:"formRef",ref:S,onKeypress:V(b,["enter"])},{default:o(()=>[s(e(l),{name:"account",class:"enter-x"},{default:o(()=>[s(e(I),{size:"large",value:i.account,"onUpdate:value":a[0]||(a[0]=u=>i.account=u),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:o(()=>[s(e(g),{size:"large",visibilityToggle:"",value:i.password,"onUpdate:value":a[1]||(a[1]=u=>i.password=u),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{class:"enter-x"},{default:o(()=>[s(e(f),{span:12},{default:o(()=>[s(e(l),null,{default:o(()=>[s(e(Q),{checked:k.value,"onUpdate:checked":a[2]||(a[2]=u=>k.value=u),size:"small"},{default:o(()=>[v(_(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(f),{span:12},{default:o(()=>[s(e(l),{style:{"text-align":"right"}},{default:o(()=>[s(e(D),{type:"link",size:"small",onClick:a[3]||(a[3]=u=>e(z)(e(R).RESET_PASSWORD))},{default:o(()=>[v(_(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:o(()=>[s(e(D),{type:"primary",size:"large",block:"",onClick:b,loading:y.value},{default:o(()=>[v(_(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),[[L,C.value]])],64))}});export{ne as _};
