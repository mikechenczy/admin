var Je=Object.defineProperty,qe=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var ke=(e,n,a)=>n in e?Je(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,M=(e,n)=>{for(var a in n||(n={}))Qe.call(n,a)&&ke(e,a,n[a]);if(pe)for(var a of pe(n))et.call(n,a)&&ke(e,a,n[a]);return e},ge=(e,n)=>qe(e,Ze(n));var ne=(e,n,a)=>new Promise((x,p)=>{var v=y=>{try{s(a.next(y))}catch(S){p(S)}},l=y=>{try{s(a.throw(y))}catch(S){p(S)}},s=y=>y.done?x(y.value):Promise.resolve(y.value).then(v,l);s((a=a.apply(e,n)).next())});import{am as tt,d as Z,f as H,af as nt,c as N,w as O,Z as B,_ as U,u as i,ac as lt,a9 as P,a5 as le,a6 as $,k as g,G as ae,a0 as ce,a1 as xe,F as Y,a8 as at,aa as Be,B as ct,l as ve,o as Ne,y as st,b as Ie,i as Me,x as rt,g as it,r as Se,J as G,h as X,m as Ce,A as be}from"./vue-ae6a2213.js";import{aG as ot,u as ut,z as dt,a5 as ht,_ as q,aH as Ke,aI as ft,aJ as yt,aK as pt,aL as kt,aM as gt,aN as me,S as xt,aO as _e,aP as vt,au as St}from"./index.js";import{ag as Ct,ah as bt,T as Kt,ai as mt,x as J,aj as _t,ak as Tt,D as Lt,k as At,f as ie,a8 as Et,al as wt,o as Dt,e as se,G as Ft,ad as Bt,am as Te,an as Nt,v as It,W as Le}from"./antd-8e9c6fb8.js";function oe(e,n){return n?typeof n=="string"?` ${e}--${n}`:Array.isArray(n)?n.reduce((a,x)=>a+oe(e,x),""):Object.keys(n).reduce((a,x)=>a+(n[x]?oe(e,x):""),""):""}function Mt(e){return(n,a)=>(n&&typeof n!="string"&&(a=n,n=""),n=n?`${e}__${n}`:e,`${n}${oe(n,a)}`)}function $e(e){return[Mt(`${ot}-${e}`)]}const Ae=Symbol(),Ee=Symbol();function $t(e,n){if(!bt(e)||e[Ee])return e;const{values:a,required:x,default:p,type:v,validator:l}=e,s=a||l?y=>{let S=!1,C=[];if(a&&(C=[...a,p],S||(S=C.includes(y))),l&&(S||(S=l(y))),!S&&C.length>0){const r=[...new Set(C)].map(h=>JSON.stringify(h)).join(", ");tt(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${r}], got value ${JSON.stringify(y)}.`)}return S}:void 0;return{type:typeof v=="object"&&Object.getOwnPropertySymbols(v).includes(Ae)&&v?v[Ae]:v,required:!!x,default:p,validator:s,[Ee]:!0}}const Ot=e=>Ct(Object.entries(e).map(([n,a])=>[n,$t(a,n)]));var E=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(E||{});const jt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Pt=Ot({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},titleClickFunc:{type:Function},titleToolTip:{type:String,default:""},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Ut={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Ht=Z({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},titleToolTip:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0},titleClickFunc:{type:Function,default:()=>{}}},emits:["strictly-change","search"],setup(e,{emit:n}){const a=H(""),[x]=$e("tree-header"),p=e,v=n,l=nt(),{t:s}=ut(),y=N(()=>["mr-1","w-full",{"ml-5":l.headerTitle||p.title}]),S=N(()=>{const{checkable:t}=p,o=[{label:s("component.tree.expandAll"),value:E.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:E.UN_EXPAND_ALL,divider:t}];return t?[{label:s("component.tree.selectAll"),value:E.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:E.UN_SELECT_ALL,divider:t},...o,{label:s("component.tree.checkStrictly"),value:E.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:E.CHECK_UN_STRICTLY}]:o}),C=({key:t})=>{var o,u,f,d;switch(t){case E.SELECT_ALL:(o=p.checkAll)==null||o.call(p,!0);break;case E.UN_SELECT_ALL:(u=p.checkAll)==null||u.call(p,!1);break;case E.EXPAND_ALL:(f=p.expandAll)==null||f.call(p,!0);break;case E.UN_EXPAND_ALL:(d=p.expandAll)==null||d.call(p,!1);break;case E.CHECK_STRICTLY:v("strictly-change",!1);break;case E.CHECK_UN_STRICTLY:v("strictly-change",!0);break}};function r(t){v("search",t)}const h=dt(r,200);return O(()=>a.value,t=>{h(t)}),O(()=>p.searchText,t=>{t!==a.value&&(a.value=t)}),(t,o)=>(B(),U("div",{class:xe([i(x)(),"flex px-2 py-1.5 items-center"])},[i(l).headerTitle?lt(t.$slots,"headerTitle",{key:0}):P("",!0),!i(l).headerTitle&&t.title?(B(),le(i(ht),{key:1,helpMessage:t.helpMessage,onClick:p.titleClickFunc},{default:$(()=>[g(i(Kt),{placement:"left",color:"#0960bd"},{title:$(()=>[ae(ce(t.titleToolTip||t.title),1)]),default:$(()=>[ae(" "+ce(t.title),1)]),_:1})]),_:1},8,["helpMessage","onClick"])):P("",!0),t.search||t.toolbar?(B(),U("div",Ut,[t.search?(B(),U("div",{key:0,class:xe(y.value)},[g(i(mt),{placeholder:i(s)("common.searchText"),size:"small",allowClear:"",value:a.value,"onUpdate:value":o[0]||(o[0]=u=>a.value=u)},null,8,["placeholder","value"])],2)):P("",!0),t.toolbar?(B(),le(i(Lt),{key:1,onClick:o[1]||(o[1]=ct(()=>{},["prevent"]))},{overlay:$(()=>[g(i(J),{onClick:C},{default:$(()=>[(B(!0),U(Y,null,at(S.value,u=>(B(),U(Y,{key:u.value},[g(i(_t),Be({ref_for:!0},{key:u.value}),{default:$(()=>[ae(ce(u.label),1)]),_:2},1040),u.divider?(B(),le(i(Tt),{key:0})):P("",!0)],64))),128))]),_:1})]),default:$(()=>[g(q,{icon:"ion:ellipsis-vertical"})]),_:1})):P("",!0)])):P("",!0)],2))}}),Vt=({icon:e})=>e?At(e)?ve(q,{icon:e,class:"mr-1"}):ve(q):null;function Xt(e,n){function a(r){const h=[],t=r||i(e),{key:o,children:u}=i(n);if(!u||!o)return h;for(let f=0;f<t.length;f++){const d=t[f];h.push(d[o]);const b=d[u];b&&b.length&&h.push(...a(b))}return h}function x(r){const h=[],t=r||i(e),{key:o,children:u}=i(n);if(!u||!o)return h;for(let f=0;f<t.length;f++){const d=t[f];d.disabled!==!0&&d.selectable!==!1&&h.push(d[o]);const b=d[u];b&&b.length&&h.push(...x(b))}return h}function p(r,h){const t=[],o=h||i(e),{key:u,children:f}=i(n);if(!f||!u)return t;for(let d=0;d<o.length;d++){const b=o[d],L=b[f];r===b[u]?(t.push(b[u]),L&&L.length&&t.push(...a(L))):L&&L.length&&t.push(...p(r,L))}return t}function v(r,h,t){if(!r)return;const o=t||i(e),{key:u,children:f}=i(n);if(!(!f||!u))for(let d=0;d<o.length;d++){const b=o[d],L=b[f];if(b[u]===r){o[d]=M(M({},o[d]),h);break}else L&&L.length&&v(r,h,b[f])}}function l(r=1,h,t=1){if(!r)return[];const o=[],u=h||i(e)||[];for(let f=0;f<u.length;f++){const d=u[f],{key:b,children:L}=i(n),Q=b?d[b]:"",V=L?d[L]:[];o.push(Q),V&&V.length&&t<r&&(t+=1,o.push(...l(r,V,t)))}return o}function s({parentKey:r=null,node:h,push:t="push"}){const o=ie(i(e));if(!r){o[t](h),e.value=o;return}const{key:u,children:f}=i(n);!f||!u||(Ke(o,d=>{if(d[u]===r)return d[f]=d[f]||[],d[f][t](h),!0}),e.value=o)}function y({parentKey:r=null,list:h,push:t="push"}){const o=ie(i(e));if(!(!h||h.length<1))if(r){const{key:u,children:f}=i(n);if(!f||!u)return;Ke(o,d=>{if(d[u]===r){d[f]=d[f]||[];for(let b=0;b<h.length;b++)d[f][t](h[b]);return e.value=o,!0}})}else{for(let u=0;u<h.length;u++)o[t](h[u]);e.value=o;return}}function S(r,h){if(!r)return;const t=h||i(e),{key:o,children:u}=i(n);if(!(!u||!o))for(let f=0;f<t.length;f++){const d=t[f],b=d[u];if(d[o]===r){t.splice(f,1);break}else b&&b.length&&S(r,d[u])}}function C(r,h,t){if(!r&&r!==0)return null;const o=h||i(e),{key:u,children:f}=i(n);return u?(o.forEach(d=>{if(t!=null&&t.key||(t==null?void 0:t.key)===0)return t;if(d[u]===r){t=d;return}d[f]&&d[f].length&&(t=C(r,d[f],t))}),t||null):null}return{deleteNodeByKey:S,insertNodeByKey:s,insertNodesByKey:y,filterByLevel:l,updateNodeByKey:v,getAllKeys:a,getChildrenKeys:p,getEnabledKeys:x,getSelectedNode:C}}function Yt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const re="context-menu",Rt={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},we=e=>{const{item:n}=e;return g("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,n)},[e.showIcon&&n.icon&&g(q,{class:"mr-2",icon:n.icon},null),g("span",null,[n.label])])},zt=Z({name:"ContextMenu",props:Rt,setup(e){const n=H(null),a=H(!1),x=N(()=>{const{axis:l,items:s,styles:y,width:S}=e,{x:C,y:r}=l||{x:0,y:0},h=(s||[]).length*40,t=S,o=document.body,u=o.clientWidth<C+t?C-t:C,f=o.clientHeight<r+h?r-h:r;return M({position:"absolute",width:`${S}px`,left:`${u+1}px`,top:`${f+1}px`,zIndex:9999},y)});Ne(()=>{st(()=>a.value=!0)}),Ie(()=>{const l=i(n);l&&document.body.removeChild(l)});function p(l,s){const{handler:y,disabled:S}=l;S||(a.value=!1,s==null||s.stopPropagation(),s==null||s.preventDefault(),y==null||y())}function v(l){return l.filter(y=>!y.hidden).map(y=>{const{disabled:S,label:C,children:r,divider:h=!1}=y,t={item:y,handler:p,showIcon:e.showIcon};return!r||r.length===0?g(Y,null,[g(J.Item,{disabled:S,class:`${re}__item`,key:C},{default:()=>[g(we,t,null)]}),h?g(Et,{key:`d-${C}`},null):null]):i(a)?g(J.SubMenu,{key:C,disabled:S,popupClassName:`${re}__popup`},{title:()=>g(we,t,null),default:()=>v(r)}):null})}return()=>{let l;if(!i(a))return null;const{items:s}=e;return g(J,{inlineIndent:12,mode:"vertical",class:re,ref:n,style:i(x)},Yt(l=v(s))?l:{default:()=>[l]})}}});const j={domList:[],resolve:()=>{}},Wt=function(e){const{event:n}=e||{};if(n&&(n==null||n.preventDefault()),!!ft)return new Promise(a=>{const x=document.body,p=document.createElement("div"),v={};e.styles&&(v.styles=e.styles),e.items&&(v.items=e.items),e.event&&(v.customEvent=n,v.axis={x:n.clientX,y:n.clientY});const l=g(zt,v);rt(l,p);const s=function(){j.resolve("")};j.domList.push(p);const y=function(){j.domList.forEach(S=>{try{S&&x.removeChild(S)}catch(C){}}),x.removeEventListener("click",s),x.removeEventListener("scroll",s)};j.resolve=function(S){y(),a(S)},y(),x.appendChild(p),x.addEventListener("click",s),x.addEventListener("scroll",s)})},De=function(){j&&(j.resolve(""),j.domList=[])};function Gt(e=!0){return it()&&e&&Ie(()=>{De()}),[Wt,De]}function Fe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Me(e)}const Jt=Z({name:"BasicTree",inheritAttrs:!1,props:Pt,emits:jt,setup(e,{attrs:n,slots:a,emit:x,expose:p}){const[v]=$e("tree"),l=Se({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),s=Se({startSearch:!1,searchText:"",searchData:[]}),y=H([]),[S]=Gt(),C=N(()=>{const{fieldNames:c}=e;return M({children:"children",title:"title",key:"key"},c)}),r=N(()=>{let c=ge(M(M({blockNode:!0},n),e),{expandedKeys:l.expandedKeys,selectedKeys:l.selectedKeys,checkedKeys:l.checkedKeys,checkStrictly:l.checkStrictly,fieldNames:i(C),"onUpdate:expandedKeys":k=>{l.expandedKeys=k,x("update:expandedKeys",k)},"onUpdate:selectedKeys":k=>{l.selectedKeys=k,x("update:selectedKeys",k)},onCheck:(k,m)=>{let K=G(l.checkedKeys);if(yt(K)&&s.startSearch){const T=m.node.eventKey;K=wt(K,Q(T)),m.checked&&K.push(T),l.checkedKeys=K}else l.checkedKeys=k;const _=G(l.checkedKeys);x("update:value",_),x("check",_,m)},onRightClick:Pe});return Dt(c,"treeData","class")}),h=N(()=>s.startSearch?s.searchData:i(y)),t=N(()=>!h.value||h.value.length===0),{deleteNodeByKey:o,insertNodeByKey:u,insertNodesByKey:f,filterByLevel:d,updateNodeByKey:b,getAllKeys:L,getChildrenKeys:Q,getEnabledKeys:V,getSelectedNode:Oe}=Xt(y,C);function je(c,k){return!k&&e.renderIcon&&se(e.renderIcon)?e.renderIcon(c):k}function Pe(m){return ne(this,arguments,function*({event:c,node:k}){var I;const{rightMenuList:K=[],beforeRightClick:_}=e;let T={event:c,items:[]};if(_&&se(_)){let w=yield _(k,c);Array.isArray(w)?T.items=w:Object.assign(T,w)}else T.items=K;(I=T.items)!=null&&I.length&&(T.items=T.items.filter(w=>!w.hidden),S(T))})}function R(c){l.expandedKeys=c}function Ue(){return l.expandedKeys}function ue(c){l.selectedKeys=c}function He(){return l.selectedKeys}function de(c){l.checkedKeys=c}function Ve(){return l.checkedKeys}function he(c){l.checkedKeys=c?V():[]}function ee(c){l.expandedKeys=c?L():[]}function Xe(c){l.checkStrictly=c}O(()=>e.searchValue,c=>{c!==s.searchText&&(s.searchText=c)},{immediate:!0}),O(()=>e.treeData,c=>{c&&te(s.searchText)});function te(c){if(c!==s.searchText&&(s.searchText=c),x("update:searchValue",c),!c){s.startSearch=!1;return}const{filterFn:k,checkable:m,expandOnSearch:K,checkOnSearch:_,selectedOnSearch:T}=i(e);s.startSearch=!0;const{title:I,key:w}=i(C),D=[];if(s.searchData=pt(i(y),A=>{var z,W;const F=k?k(c,A,i(C)):(W=(z=A[I])==null?void 0:z.includes(c))!=null?W:!1;return F&&D.push(A[w]),F},i(C)),K){const A=kt(s.searchData).map(F=>F[w]);A&&A.length&&R(A)}_&&m&&D.length&&de(D),T&&D.length&&ue(D)}function Ye(c,k){if(!(!e.clickRowToExpand||!k||k.length===0))if(!l.expandedKeys.includes(c))R([...l.expandedKeys,c]);else{const m=[...l.expandedKeys],K=m.findIndex(_=>_===c);K!==-1&&m.splice(K,1),R(m)}}X(()=>{y.value=e.treeData}),Ne(()=>{const c=parseInt(e.defaultExpandLevel);c>0?l.expandedKeys=d(c):e.defaultExpandAll&&ee(!0)}),X(()=>{l.expandedKeys=e.expandedKeys}),X(()=>{l.selectedKeys=e.selectedKeys}),X(()=>{l.checkedKeys=e.checkedKeys}),O(()=>e.value,()=>{l.checkedKeys=G(e.value||[])},{immediate:!0}),O(()=>l.checkedKeys,()=>{const c=G(l.checkedKeys);x("update:value",c),x("change",c)}),X(()=>{l.checkStrictly=e.checkStrictly});const Re={getTreeData:()=>y,setExpandedKeys:R,getExpandedKeys:Ue,setSelectedKeys:ue,getSelectedKeys:He,setCheckedKeys:de,getCheckedKeys:Ve,insertNodeByKey:u,insertNodesByKey:f,deleteNodeByKey:o,updateNodeByKey:b,getSelectedNode:Oe,checkAll:he,expandAll:ee,filterByLevel:c=>{l.expandedKeys=d(c)},setSearchValue:c=>{te(c)},getSearchValue:()=>s.searchText};function ze(c){const{actionList:k}=e;if(!(!k||k.length===0))return k.map((m,K)=>{var T;let _=!0;return se(m.show)?_=(T=m.show)==null?void 0:T.call(m,c):Le(m.show)&&(_=m.show),_?g("span",{key:K,class:v("action")},[m.render(c)]):null})}const We=N(()=>{const c=ie(h.value);return gt(c,(k,m)=>{var ye;const K=s.searchText,{highlight:_}=i(e),{title:T,key:I,children:w}=i(C),D=je(k,k.icon),A=Nt(k,T),F=K?A.indexOf(K):-1,z=s.startSearch&&!It(K)&&_&&F!==-1,W=`color: ${Le(_)?"#f50":_}`,Ge=z?g("span",{class:(ye=i(r))!=null&&ye.blockNode?`${v("content")}`:""},[g("span",null,[A.substr(0,F)]),g("span",{style:W},[K]),g("span",null,[A.substr(F+K.length)])]):A,fe=D?g(Vt,{icon:D},null):a.icon?g("span",{class:"mr-1"},[_e(a,"icon")]):null;return k[T]=g("span",{class:`${v("title")} pl-2`,onClick:Ye.bind(null,k[I],k[w])},[a!=null&&a.title?g(Y,null,[fe,_e(a,"title",k)]):g(Y,null,[fe,Ge,g("span",{class:v("actions")},[ze(k)])])]),k}),c});return p(Re),()=>{let c,k;const{title:m,helpMessage:K,toolbar:_,search:T,checkable:I,titleClickFunc:w,titleToolTip:D}=e,A=m||_||T||a.headerTitle,F={height:"calc(100% - 38px)","margin-top":"12px"};return g("div",{class:[v(),"h-full",n.class]},[A&&g(Ht,{checkable:I,checkAll:he,expandAll:ee,titleClickFunc:w,title:m,titleToolTip:D,search:T,toolbar:_,helpMessage:K,onStrictlyChange:Xe,onSearch:te,searchText:s.searchText},Fe(c=me(a))?c:{default:()=>[c]}),g(Ft,{wrapperClassName:i(e.treeWrapperClassName),spinning:i(e.loading),tip:"加载中..."},{default:()=>[Ce(g(xt,{style:F},{default:()=>[g(Bt,Be(i(r),{showIcon:!1,treeData:We.value}),Fe(k=me(a,["title"]))?k:{default:()=>[k]})]}),[[be,!i(t)]]),Ce(g(Te,{image:Te.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,i(t)]])]})])}}});const qt={class:"overflow-hidden bg-white"},nn=Z({name:"AnnoTableTree",__name:"AnnoTableTree",props:{leftTreeClass:{},leftTreeCatKey:{},leftTreeName:{default:"选择分类"}},emits:["select"],setup(e,{emit:n}){const a=n,x=H([]),p=H(window.innerHeight-180),{createMessage:v}=St(),l=()=>{s(C.value),v.success("刷新成功")};window.onresize=()=>{p.value=window.innerHeight-180};function s(r){return ne(this,null,function*(){x.value=yield vt({annoClazz:r})})}function y(r){a("select",r[0])}const S=e,C=N(()=>{var r;return(r=S.leftTreeClass)==null?void 0:r.split(".").slice(-1)[0]});return O(C,()=>{s(C.value)},{immediate:!0}),(r,h)=>(B(),U("div",qt,[g(i(Jt),{title:S.leftTreeName,toolbar:"",search:"",treeWrapperClassName:"h-[calc(100%-35px)] overflow-auto",titleClickFunc:l,titleToolTip:"点击刷新",clickRowToExpand:!1,height:i(p),treeData:i(x),fieldNames:{key:"id",title:"title"},onSelect:y},null,8,["title","height","treeData"])]))}});export{nn as _};
